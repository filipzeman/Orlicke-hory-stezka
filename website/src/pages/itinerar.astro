---
import BaseLayout from "../layouts/BaseLayout.astro";
import { points } from "../data/mockPoints";
import PointCard from "../components/PointCard.astro";
import IconGuide from "../components/IconGuide.astro";
// import ItineraryFilter from "../components/ItineraryFilter";

// Sort by km
const sortedPoints = [...points].sort((a, b) => a.km - b.km);

const filter = Astro.url.searchParams.get("filter");

const filteredPoints = sortedPoints.filter((point) => {
  if (!filter || filter === "all") return true;
  if (filter === "sleeping") return point.sleeping.length > 0;
  if (filter === "food") return point.food.length > 0;
  if (filter === "water") return point.water;
  return true;
});
---

<BaseLayout title="Itinerář | Orlické hory">
  <section class="container">
    <h1>Itinerář</h1>
    <p>Přehled bodů podél trasy etapy Orlické hory.</p>
    <IconGuide />
  </section>

  <section class="container">
    <div class="filters">
      <a href="/itinerar">Vše</a>
      <a href="/itinerar?filter=sleeping">Ubytování</a>
      <a href="/itinerar?filter=food">Jídlo</a>
      <a href="/itinerar?filter=water">Voda</a>
    </div>
  </section>

  <section class="container points">
    {filteredPoints.map((point) => <PointCard point={point} />)}
  </section>
</BaseLayout>

<style>
  .points {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
</style>
